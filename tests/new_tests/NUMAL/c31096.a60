c̲o̲d̲e̲ 31096;
p̲r̲o̲c̲e̲d̲u̲r̲e̲COMFOUSER1(N,THETA,AR,AI,RR,RI);
   v̲a̲l̲u̲e̲N,THETA;i̲n̲t̲e̲g̲e̲r̲N;r̲e̲a̲l̲THETA,RR,RI;a̲r̲r̲a̲y̲AR,AI;
b̲e̲g̲i̲n̲i̲n̲t̲e̲g̲e̲r̲K;r̲e̲a̲l̲H,HR,HI,CO,SI;
   HR:=HI:=0;CO:=COS(THETA);SI:=SIN(THETA);
   f̲o̲r̲K:=Ns̲t̲e̲p̲-1u̲n̲t̲i̲l̲1d̲o̲
      b̲e̲g̲i̲n̲H:=CO×HR-SI×HI+AR[K];
         HI:=CO×HI+SI×HR+AI[K];
         HR:=H
      e̲n̲d̲;
   RR:=CO×HR-SI×HI+AR[0];
   RI:=CO×HI+SI×HR+AI[0]
e̲n̲d̲COMFOUSER1;
e̲o̲p̲

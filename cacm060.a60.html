<html><head><meta charset="utf-8"></head><body><pre><u>real</u> <u>procedure</u> rombergintegr(fct, lgr, rgr, ord);
   <u>value</u> lgr, rgr, ord;
   <u>real</u> lgr, rgr; <u>integer</u> ord; <u>real</u> <u>procedure</u> fct ;
     <u>comment</u> ;
<u>begin</u>
   <u>real</u> <u>array</u> t[1:ord+1];
   <u>real</u> l, u, m;
   <u>integer</u> f, h, j, n;
   l ≔ rgr - lgr;
   t[1] ≔ (fct(lgr) + fct(rgr))/2;
   n ≔ 1;
   <u>for</u> h ≔ 1 <u>step</u> 1 <u>until</u> ord <u>do</u>
      <u>begin</u> u ≔ 0;
         m ≔ l/(2×n);
         <u>for</u> j ≔ 1 <u>step</u> 2 <u>until</u> 2×n - 1 <u>do</u>
              u ≔ u + fct(lgr + j×m);
         t[h + 1] ≔ (u/n + t[h])/2;
         f ≔ 1;
         <u>for</u> j ≔ h <u>step</u> -1 <u>until</u> 1 <u>do</u>
            <u>begin</u> f ≔ 4×f;
               t[j] ≔ t[j + 1] + (t[j+1] - t[j])/(f - 1)
            <u>end</u> ;
         n ≔ 2 × n
      <u>end</u> ;
   rombergintegr ≔ t[1] × l
<u>end</u>;
</pre></body></html>
